Key,Name,Status,Precondition,Objective,Folder,Priority,Component,Labels,Owner,Estimated Time,Coverage (Issues),Coverage (Pages),Test Script (Step-by-Step) - Step,Test Script (Step-by-Step) - Test Data,Test Script (Step-by-Step) - Expected Result,Test Script (Plain Text),Test Script (BDD)
,1-Validate table delta_gold.fusion_gl_balances and its metadata is matching with Miro/Interface Contract,Draft,,,,Normal,,,,,,,,,,,Given the table delta_gold.fusion_gl_balances exists When the metadata is compared with the Miro/Interface contract Then the schema should match exactly
,"2-Verify on running the job pl_gold_load manually, if the job fails Then data shouldn't move from silver to gold. Email notification should also be triggered for the same.",Draft,,,,Normal,,,,,,,,,,,Given the job pl_gold_load is triggered manually When the job fails Then no data should be moved from silver to goldAnd an email notification should be sent
,"3-Verify on running the job pl_gold_load manually, if the job is successful Then the data should be moved from silver to gold.",Draft,,,,Normal,,,,,,,,,,,Given the job pl_gold_load is triggered manually When the job completes successfully Then the data should be moved from silver to gold
,4-Verify all the dependency tables/files are available as a prerequisite for loading the table.,Draft,,,,Normal,,,,,,,,,,,Given the pipeline is ready to load data When it checks for all prerequisite tables/files Then all dependencies must be available
,5-Verify that records with null Fusion_Code are rejected/flagged.,Draft,,,,Normal,,,,,,,,,,,Given a record has a null Fusion_Code When it is processed by the pipeline Then it should be rejected or flagged
,6-Verify the data is loading for all the default columns.,Draft,,,,Normal,,,,,,,,,,,Given the pipeline runs successfully When default columns are populated Then all default columns should contain valid data
,7-Check for primary key column,Draft,,,,Normal,,,,,,,,,,,Given the gold table is created When primary key constraints are checked Then the primary key column should be defined
,8-Verify if non-null columns in silver table shouldn't have null in gold table (delta_gold.fdmee_mapping_balance_account),Draft,,,,Normal,,,,,,,,,,,Given non-null columns in the silver table When the data is moved to the gold layer Then those columns should not have null values in gold
,"9-Verify the row count matches between silver and gold layer based on fusion_code, fusion_cost_centre unique combinations",Draft,,,,Normal,,,,,,,,,,,Given silver and gold tables contain data When rows are grouped by fusion_code and fusion_cost_centre Then the row count should match between both layers
,"10-Ensure YEAR_PERIOD_NUMBER is a 6-digit string (e.g., 202412).",Draft,,,,Normal,,,,,,,,,,,Given a YEAR_PERIOD_NUMBER column When values are validated Then each value should be a 6-digit string
,11-Verify the email notification for successful/failure job run.,Draft,,,,Normal,,,,,,,,,,,Given the job is executed When the job completes successfully or fails Then an email notification should be sent accordingly
,12-Verify the logs,Draft,,,,Normal,,,,,,,,,,,Given the pipeline runs When the job finishes execution Then logs should be generated and stored
,13-Verify if the partition column is year_period_number,Draft,,,,Normal,,,,,,,,,,,Given the delta_gold.fusion_gl_balances table When partition information is checked Then the table should be partitioned by year_period_number
,"14-Verify the column hfm_entity is picked from delta_silver.dim_fdmee_mapping_slv(target_entity) only for 'UKCORE_TOT' entities except 'SB4001','SB4002','SB4003','SB4006' and named as 'UKCORE_CF' except for 'SB1109','SB1151'",Draft,,,,Normal,,,,,,,,,,,Given data with UKCORE_TOT entities When the target_entity is mapped Then hfm_entity should be 'UKCORE_CF' with correct exclusions
,"15-Verify the column hfm_entity contains only 3 values 'UKCORE_CF','SB1109','SB1151' and not null",Draft,,,,Normal,,,,,,,,,,,"Given the gold layer data When values in hfm_entity are validated Then only 'UKCORE_CF','SB1109','SB1151' should exist and none should be null"
,"16-Verify the column gl_period is picked from delta_silver.fact_fusion_glbalances_slv only for Tesco GB Primary ledger and transformed as concat('0', balance_period_num) if length is 1",Draft,,,,Normal,,,,,,,,,,,Given records for Tesco GB Primary ledger When balance_period_num is used Then gl_period should be transformed as a 2-digit string with leading 0 if needed
,17-Verify the column gl_period contains only numeric and only 2 digit and not null,Draft,,,,Normal,,,,,,,,,,,Given the column gl_period When values are validated Then all values should be 2-digit numeric and not null
,"18-Verify the column gl_scenario is picked from delta_silver.fact_fusion_glbalances_slv only for Tesco GB Primary ledger and transformed as concat('ACT', balance_period_year)",Draft,,,,Normal,,,,,,,,,,,Given records for Tesco GB Primary ledger When balance_period_year is used Then gl_scenario should be 'ACT' concatenated with the year
,19-Verify the column gl_scenario contains alphanumeric and length is only 7 and not null,Draft,,,,Normal,,,,,,,,,,,"Given the column gl_scenario When values are validated Then all should be alphanumeric, exactly 7 characters long, and not null"
,20-Verify the column hfm_account is mapped from target_account in delta_silver.dim_fdmee_mapping_slv against the source_account,Draft,,,,Normal,,,,,,,,,,,Given the source_account mapping When target_account is looked up Then hfm_account should be correctly populated from the mapping table
,21-Verify the column hfm_category is mapped from target_ledger in delta_silver.dim_fdmee_mapping_slv against the source_account,Draft,,,,Normal,,,,,,,,,,,Given the source_account mapping When target_ledger is looked up Then hfm_category should be correctly populated from the mapping table
,22-Verify the hfm_category is alphanumeric and not null,Draft,,,,Normal,,,,,,,,,,,Given the column hfm_category When values are validated Then all values should be alphanumeric and not null
,23-Verify the column gl_account is mapped from node in delta_silver.dim_fusion_account_hierarchy only for Balance Sheet and P&L accounts,Draft,,,,Normal,,,,,,,,,,,Given Balance Sheet and P&amp;L accounts When node is fetched from the hierarchy table Then gl_account should be mapped correctly
,24-Verify the column gl_account is alphanumeric and not null,Draft,,,,Normal,,,,,,,,,,,Given the column gl_account When values are validated Then all values should be alphanumeric and not null
,"25-Verify the column gl_cost_centre_code is mapped from source_cost_centre in delta_silver.dim_fdmee_mapping_slv against the source_account, leave blank for Balance Sheet accounts",Draft,,,,Normal,,,,,,,,,,,Given the source_account When source_cost_centre is mapped Then gl_cost_centre_code should be correctly populated or left blank for Balance Sheet accounts
,26-Verify the column gl_cost_centre_code is alphanumeric and contains null,Draft,,,,Normal,,,,,,,,,,,Given the column gl_cost_centre_code When values are validated Then values should be alphanumeric or null
,"27-Verify the column gl_cost_centre_name is mapped from description in delta_silver.dim_fusion_costcentre_slv against the cost_centre_code, leave blank for Balance Sheet accounts",Draft,,,,Normal,,,,,,,,,,,Given the cost_centre_code When description is mapped Then gl_cost_centre_name should be populated correctly or left blank for Balance Sheet accounts
,28-Verify the column gl_cost_centre_name is alphanumeric and contains null,Draft,,,,Normal,,,,,,,,,,,Given the column gl_cost_centre_name When values are validated Then values should be alphanumeric or null
,29-Verify the column gl_last_extracted is mapped from source_extracted_date in delta_silver.fact_fusion_glbalances_slv only for Tesco GB Primary ledger,Draft,,,,Normal,,,,,,,,,,,Given Tesco GB Primary ledger data When source_extracted_date is fetched Then gl_last_extracted should be mapped accordingly
,30-Verify the column gl_last_extracted is timestamp and not null,Draft,,,,Normal,,,,,,,,,,,Given the column gl_last_extracted When values are validated Then all values should be timestamps and not null
,"31-Verify the columns gl_ob_debit, gl_ob_credit, gl_movement_debit, gl_movement_credit, gl_periodic_movement, gl_closing_balance are mapped from delta_silver.fact_fdmee_transformed_data, summed and aggregated at fusion_account, fusion_cost_centre_code",Draft,,,,Normal,,,,,,,,,,,Given the data in fact_fdmee_transformed_data When values are grouped by fusion_account and fusion_cost_centre_code Then the above columns should be mapped and aggregated accordingly
,"32-Verify the columns gl_ob_debit, gl_ob_credit, gl_movement_debit, gl_movement_credit, gl_periodic_movement, gl_closing_balance are numeric",Draft,,,,Normal,,,,,,,,,,,Given the financial columns in gold layer When values are validated Then all should be numeric
,33-Validate that only the latest YEAR_PERIOD_NUMBER is loaded if multiple versions exist,Draft,,,,Normal,,,,,,,,,,,Given multiple records for the same entity with different YEAR_PERIOD_NUMBERs When the job runs Then only the latest period data should be loaded
,34-Validate pipeline behavior When Silver layer is empty,Draft,,,,Normal,,,,,,,,,,,Given an empty silver layer When the pipeline runs Then no data should be loaded and pipeline should not fail
,35-Validate pipeline behavior When lookup table is missing or corrupted,Draft,,,,Normal,,,,,,,,,,,Given a missing or corrupted lookup table When the job executes Then the pipeline should fail with a meaningful error message
,"36-Validate maximum length constraints for cost_centre_name (e.g., truncate or reject if too long)",Draft,,,,Normal,,,,,,,,,,,Given a long value for cost_centre_name When the pipeline processes it Then the value should be truncated or the record should be rejected as per design
,37-Validate load_date_time is correctly populated with pipeline current timestamp,Draft,,,,Normal,,,,,,,,,,,Given a pipeline run When records are inserted into gold layer Then load_date_time should reflect the current timestamp
,38-Validate pipeline_run_id is correctly generated and unique per run,Draft,,,,Normal,,,,,,,,,,,Given each pipeline execution When data is loaded Then a unique pipeline_run_id should be assigned to all rows
,39-Validate finance_year_period_number is null or defaulted as per logic,Draft,,,,Normal,,,,,,,,,,,Given new data When finance_year_period_number is populated Then it should be either null or match default logic
,"40-Ingest a record with a future YEAR_PERIOD_NUMBER (e.g., 202512) and verify it is accepted if allowed",Draft,,,,Normal,,,,,,,,,,,Given a future-dated record When the job processes it Then the record should be accepted only if future periods are allowed by the logic
,41-Ensure duplicate records are not loaded into Gold Layer delta_gold.fusion_gl_balances,Draft,,,,Normal,,,,,,,,,,,Given duplicate records in source When the pipeline loads data Then only distinct records should be loaded into the gold layer
,"42-Validate any primary key (gl_account, gl_cost_centre_code) duplicate is there in Gold Layer delta_gold.fusion_gl_balances",Draft,,,,Normal,,,,,,,,,,,Given data loaded into the gold layer When duplicates on primary key combinations are checked Then no duplicates should exist
,43-Ingest a new fusion_string in balance not in fdmee_mapping and verify how it works,Draft,,,,Normal,,,,,,,,,,,Given a fusion_string not mapped in fdmee_mapping When pipeline runs Then it should either flag or reject the record as per mapping validation logic
,44-Ingest invalid data for numeric types and verify how data quality is handled,Draft,,,,Normal,,,,,,,,,,,"Given invalid data for numeric columns When pipeline tries to cast or load Then records should be flagged, rejected, or corrected per DQ rules"
,45-Verify all metric data is matching with GL balance table after load into Gold Layer,Draft,,,,Normal,,,,,,,,,,,Given metric columns in silver and gold When comparison is done Then totals and aggregates should match across both layers
,"46-Ensure duplicate records are removed during 1:M, M:M relationships",Draft,,,,Normal,,,,,,,,,,,Given 1:M or M:M joins in transformation When data is processed Then duplicate or exploded records should be eliminated before final load
,47-Ingest null records for not-null columns and check how it is handled,Draft,,,,Normal,,,,,,,,,,,Given source records with nulls in mandatory columns When data is validated Then records should be rejected or flagged per business rules
,48-Verify the HFM code and Fusion Code are not same,Draft,,,,Normal,,,,,,,,,,,Given records with both hfm_code and fusion_code When compared Then they should not have the same values unless explicitly allowed
,49-Verify passing invalid YEAR_PERIOD_NUMBER in pipeline parameter and see how it works,Draft,,,,Normal,,,,,,,,,,,"Given an invalid YEAR_PERIOD_NUMBER (e.g., not 6-digit) When passed to pipeline Then pipeline should fail or raise a validation error"
,50-Validate that YEAR_PERIOD_NUMBER is rejected if not a 6-digit string,Draft,,,,Normal,,,,,,,,,,,Given a record with an invalid YEAR_PERIOD_NUMBER When pipeline loads data Then such records should be rejected
,51-Validate that the Gold table is fully refreshed for each YEAR_PERIOD_NUMBER. Ensure any existing data for the same partition is completely replaced.,Draft,,,,Normal,,,,,,,,,,,Given a pipeline run for a specific period When data for that partition already exists Then the existing data should be replaced with the new data
,"52-Ingest invalid period name against a period year, see how pipeline handles",Draft,,,,Normal,,,,,,,,,,,Given an invalid period name for a given year When pipeline tries to map it Then the record should be flagged or rejected
,53-Ensure all the tables are joined based on same year_period_number,Draft,,,,Normal,,,,,,,,,,,Given multiple tables joined in transformation When join condition is evaluated Then all joins must be on matching year_period_number
,54-Verify all the dependency table have complete data to avoid missing of record/value,Draft,,,,Normal,,,,,,,,,,,"Given all prerequisite dependency tables and files are available
When the pipeline is triggered
Then Validate partitioning by `year_period_number`. Ensure Gold table is partitioned correctly based on `year_period_number` values."
,55-Validate the scheduled trigger is working as expected by running the pipeline on scheduled time.,Draft,,,,Normal,,,,,,,,,,,"Given all prerequisite dependency tables and files are available
When the pipeline is triggered
Then Verify the maximum length of column description and its exceeeds or not"
,56 - Pipelline Execution when dependent Dimension table has no data for joining period,Draft,,,,Normal,,,,,,,,,,,"Given Data is not available for Dependent Tables for year period the Main Job Runs
Then run th pipeline
And if no data for particular year period number 
Then Pick the data from max (year period number)"
,57 - Validate Account Hierarchy Date Range,Draft,,,,Normal,,,,,,,,,,,"Given the tables delta_gold.fusion_gl_balances and delta_silver.dim_fusion_account_hierarchy_slv exist
When I check if load_date_time falls between start_date and end_date for the mapped fusion_code
Then no record should violate the date range rule"
